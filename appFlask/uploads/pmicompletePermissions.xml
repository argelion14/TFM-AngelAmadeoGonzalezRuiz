<?xml version="1.0" encoding="UTF-8"?>
<dds xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:noNamespaceSchemaLocation="http://community.rti.com/schema/7.3.0/dds_security_permissions.xsd">

  <permissions>

    <!-- Grant para un operador -->
    <grant name="OperatorGrant">
      <subject_name>C=US, ST=CA, O=Real Time Innovations, emailAddress=ecdsa01Peer01@rti.com, CN=RTI ECDSA01 (p256) PEER01</subject_name>
      <validity>
        <not_before>2023-01-01T00:00:00Z</not_before>
        <not_after>2030-01-01T00:00:00Z</not_after>
      </validity>

      <allow_rule>
        <domains>
          <id>1</id>
          <id>2</id>
          <id>3</id>
        </domains>
        <subscribe>
          <topics>
            <topic>telemetry</topic>
          </topics>
        </subscribe>
        <publish>
          <topics>
            <topic>telemetry</topic>
          </topics>
        </publish>
      </allow_rule>

      <default>DENY</default>
    </grant>

    <!-- Grant para un controlador remoto -->
    <grant name="RemoteDriverGrant">
      <subject_name>C=ES, ST=Madrid, O=Mi Empresa, emailAddress=usuario2@miempresa.com, CN=Certificado Usuario2</subject_name>
      <validity>
        <not_before>2024-06-01T00:00:00Z</not_before>
        <not_after>2031-06-01T00:00:00Z</not_after>
      </validity>

      <allow_rule>
        <domains>
          <id>2</id>
        </domains>
        <publish>
          <topics>
            <topic>remote_control</topic>
          </topics>
        </publish>
        <subscribe>
          <topics>
            <topic>status_update</topic>
          </topics>
        </subscribe>
        <publish>
          <topics>
            <topic>telemetry</topic>
          </topics>
        </publish>
      </allow_rule>

      <default>DENY</default>
    </grant>

    <!-- Grant para un dron -->
    <grant name="DroneGrant">
      <subject_name>C=ES, ST=Andalucía, O=DroneCorp, emailAddress=drone01@dronecorp.com, CN=Drone 01</subject_name>
      <validity>
        <not_before>2025-01-01T00:00:00Z</not_before>
        <not_after>2035-01-01T00:00:00Z</not_after>
      </validity>

      <allow_rule>
        <domains>
          <id>1</id>
        </domains>
        <publish>
          <topics>
            <topic>video_feed</topic>
            <topic>telemetry</topic>
          </topics>
        </publish>
        <publish>
          <topics>
            <topic>telemetry</topic>
          </topics>
        </publish>
      </allow_rule>

      <default>DENY</default>
    </grant>

    <!-- Grant para estación de campo -->
    <grant name="FieldStationGrant">
      <subject_name>C=ES, ST=Toledo, O=JCCM, emailAddress=fieldstation@jccm.es, CN=Field Station 1</subject_name>
      <validity>
        <not_before>2022-05-01T00:00:00Z</not_before>
        <not_after>2032-05-01T00:00:00Z</not_after>
      </validity>

      <allow_rule>
        <domains>
          <id>3</id>
        </domains>
        <subscribe>
          <topics>
            <topic>telemetry</topic>
          </topics>
        </subscribe>
        <publish>
          <topics>
            <topic>telemetry</topic>
          </topics>
        </publish>
      </allow_rule>

      <default>DENY</default>
    </grant>

  </permissions>
</dds>
